---
output: 
  html_document:
    css: styles.css
    includes:
      after_body: footer.html
---

```{r setup, include=FALSE}
library(tidyverse)
library(scholar)
library(kableExtra)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(rorcid)
x  <- "dc7ea3ae-38fd-4188-8bd1-1db4215ea139"
Sys.setenv(ORCID_TOKEN=x)
```

# Aaron Conway RN PhD

----

>  RBC Chair in Cardiovascular Nursing Research | Peter Munk Cardiac Centre<br>Assistant Professor | Lawrence S. Bloomberg Faculty of Nursing | University of Toronto<br>aaron.conway@utoronto.ca


----

  
## Education

```{r}
edu <- rorcid::orcid_educations("0000-0002-9583-8636")
edu <- edu$`0000-0002-9583-8636`$`education-summary` %>% 
  janitor::clean_names() %>% 
  mutate(end_date = replace_na(`end_date_year_value`, "Current")) %>%
  mutate(timeframe = glue::glue("{start_date_year_value} - {end_date}")) %>% 
    mutate(location = glue::glue("{organization_address_city}, {organization_address_country}")) %>% 
  select(role_title, organization_name, location, timeframe)
kable(edu, col.names = c("", "", "", ""))%>% 
    kable_styling(bootstrap_options = "hover") 
```

## Employment

```{r}
employ <- rorcid::orcid_employments("0000-0002-9583-8636")
employ <- employ$`0000-0002-9583-8636`$`employment-summary` %>% 
  janitor::clean_names() %>% 
  mutate(end_date = replace_na(`end_date_year_value`, "Current")) %>%
  mutate(timeframe = glue::glue("{start_date_year_value} - {end_date}")) %>% 
    mutate(location = glue::glue("{organization_address_city}, {organization_address_country}")) %>% 
  select(role_title, organization_name, location, timeframe)
kable(employ,  col.names = c("", "", "", ""))%>% 
      column_spec(1, width = "18em") %>% 
    column_spec(2, width = "18em") %>% 
    kable_styling(bootstrap_options = "hover") 
```

## Funding


```{r}
funding <- rorcid::orcid_fundings("0000-0002-9583-8636")
pcodes <- vapply(funding[[1]]$group$`funding-summary`, "[[", 1, "put-code")
out <- lapply(pcodes, function(z) orcid_fundings("0000-0002-9583-8636", put_code=z))
amount <- vapply(out, function(w) w[[1]]$amount$value, "")
amount  <- paste("$", amount, sep = "")
funding <- funding$`0000-0002-9583-8636`$group$`funding-summary` 
funding <- tibble(
  type = map_chr(funding, "type"),
  funder = map_chr(funding, "organization.name"),
  title = map_chr(funding, "title.title.value"),
  start = map_chr(funding, "start-date.year.value"),
  end = map_chr(funding, "end-date.year.value")) %>% 
  mutate(timeframe = glue::glue("{start} - {end}")) %>% 
  select(type, funder, title, timeframe) 
funding$type <- stringr::str_replace_all(funding$type, "SALARY_AWARD", "SALARY AWARD")
  funding <- funding %>% 
  mutate(Amount = amount)
kable(funding,  col.names = c("Type", "Funder", "Title", "Duration", "Amount")) %>%
    column_spec(1, width = "5em") %>% 
    column_spec(2, width = "12em") %>% 
  column_spec(3, width = "20em") %>% 
    kable_styling(bootstrap_options = "hover") 
```

## Publications
```{r}
id <- "2hpmnr8AAAAJ"

## Get his profile
l <- get_profile(id)
```

```{r}
scholar <- scholar::get_publications(id) 
impact <- get_impactfactor(journals=scholar$journal, max.distance = 0.1)
scholar <- cbind(scholar, impact)
```

```{r}
papers <- get_num_articles(id)
journals  <- get_num_distinct_journals(id)
```
<br>

>Dr Conway's publication metrics indicate a rising trajectory in terms of the quality and quantity of academic papers he has published and the citation count of those papers. Aaron has published `r papers` articles in `r journals` distinct journals across multiple disciplines including nursing, anesthesia and cardiology. His publications have been cited `r l$total_cites` times, with a current H-index of `r l$h_index` and `r l$i10_index` publications have at least 10 citations. The plots below shows the number of publications and citations per year since he started an academic career.

<br>
```{r out.width=c('50%', '50%'), fig.show='hold'}
scholar %>% 
  group_by(year) %>% 
  summarise(pubsperyear = n()) %>% 
  mutate(total = cumsum(pubsperyear)) %>% 
ggplot(aes(year, total)) +
    geom_segment(aes(xend = year, yend = 0), size=1, color='darkgrey') +
    geom_point(size=3, color="#3c8dbc") +
    theme_classic() +
    labs(x= "Year", y = "Publications") +
  scale_x_continuous(breaks = 2010:max(scholar$year, na.rm = TRUE))

ct <- get_citation_history(id)

## Plot citation trend
ggplot(ct, aes(year, cites)) +
    geom_segment(aes(xend = year, yend = 0), size=1, color='darkgrey') +
    geom_point(size=3, color="#3c8dbc") +
    theme_classic() +
    labs(x= "Year", y = "Citations")

```


```{r}


```

<br><br>
```{r }
scholar%>% 
  select(title, author, journal, year, cites, ImpactFactor) %>%
  kable(col.names = c("Title", "Authors", "Journal", "Year", "Total Citations", "Impact Factor")) %>%
  kable_styling(bootstrap_options = "hover") %>% 
  scroll_box(width = "auto%", height = "600px")
```

